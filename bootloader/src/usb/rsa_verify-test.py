import os
import subprocess
from binascii import b2a_hex

m = 0xd3582e0e6ef0c60f5f4d82850bc0dfbe867043bcb276dc95be175ca890c4865c16d928795c5def673a6301cb7cbdefc6a97013582264adb0a988dca63f914f93fc685cc7a39d2e418066ae7b0540ae2f0c8e5e8339536760c9cafe864f261894da8a3362c4feb2265d177e56ddbd901dd3574722986dd4baca3509edcc3b9d880321d4bf00844984706a7a7168b97d07e3e08e48a64e90063f14c4605c78ae28e50f3f6100d9b374473e01917daa18cb8af87a224b14eb80c3fe168019253562bf21c7f4ea60de28bc1ee17d3a3cc99c008600fbd6202baea0af82f3811df9ab0f843ff73cec48f61d5ce1e44506400615f67bcbbaaadb0c689e6c065e462a05

d = 0x8ce574099f4b2eb4ea33ac58b2809529aef5827dcc4f3db92964e8706083043d6490c5a63d93f4ef7c42013253294a8470f5623ac19873cb1bb093197fb6350d52f03dda6d13742baaef1efcae2b1eca085ee9acd0e244eb3131ff0434c410633c5c2241d8a9cc199364fee493d3b569378f84c1baf3e3273178b14932d26904211089721f2bbdd4aeb70767c193e19fc9b783aff248d113ed4a1f259ea31bfb467c1514000a41422c74c4d222ed5058e2c346e9c179100d79523e8a8d699120fd20777905eb146b4ace1df4f75a1c22197921fcf93312691210049e7187c0527d53c31c2a91448766c25ac45f6038e2f9c3ce099973c824db4755c9664ae22b


h_hex = b'00' + b2a_hex(os.urandom(255))
h = int(h_hex, 16)

c = pow(h, d, m)

ret = subprocess.call(["./main", h_hex[-64:], "%0512x" % c])
print(ret)
